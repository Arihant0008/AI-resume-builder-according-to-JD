<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Resume Builder</title>
  <style>
    * { box-sizing: border-box; }

    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #121212;
      margin: 0;
      padding: 20px;
      color: #f0f0f0;
      min-height: 100vh;
    }

    .wrapper {
      display: flex;
      gap: 24px;
      max-width: 1400px;
      margin: 0 auto;
      min-height: 80vh;
    }

    .container {
      flex: 1;
      background: #1e1e2f;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.7);
      padding: 28px;
      overflow-y: auto;
      max-height: 90vh;
    }

    .container:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.9);
      transition: all 0.2s ease;
    }

    h2 {
      text-align: center;
      color: #00e0ff;
      margin-bottom: 24px;
      font-size: 24px;
      font-weight: 700;
      text-shadow: 0 0 8px rgba(0,224,255,0.5);
    }

    h3 {
      margin: 24px 0 16px 0;
      color: #ffcc00;
      font-size: 18px;
      border-left: 4px solid #ffcc00;
      padding-left: 12px;
      text-shadow: 0 0 5px rgba(255,204,0,0.4);
    }

    label {
      font-weight: 500;
      color: #e0e0e0;
      display: block;
      margin-top: 16px;
      margin-bottom: 6px;
    }

    textarea, input[type="number"], select {
      width: 100%;
      margin-bottom: 16px;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #444;
      background: #2c2c3c;
      color: #f0f0f0;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      transition: border 0.2s ease, box-shadow 0.2s ease;
    }

    textarea {
      min-height: 120px;
      resize: vertical;
      font-family: 'Courier New', monospace;
      line-height: 1.4;
    }

    #resume {
      min-height: 200px;
      height: 200px;
    }

    textarea:focus, input:focus, select:focus {
      outline: none;
      border-color: #00e0ff;
      box-shadow: 0 0 8px rgba(0,224,255,0.5);
    }

    input[type="number"] { height: 45px; }
    select { height: 45px; }

    button[type="submit"] {
      background: #00e0ff;
      color: #121212;
      border: none;
      border-radius: 8px;
      padding: 16px;
      width: 100%;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      margin-top: 20px;
      transition: all 0.3s ease;
    }

    button[type="submit"]:hover {
      background: #00b8cc;
      transform: translateY(-2px);
      box-shadow: 0 6px 14px rgba(0,224,255,0.5);
    }

    button[type="submit"]:disabled {
      background: #666;
      cursor: not-allowed;
      transform: none;
    }

    #downloadResume, #downloadQuestions {
      display: block;
      margin: 12px 0;
      padding: 12px 18px;
      background: #ff6f61;
      color: #fff;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 500;
      text-align: center;
      transition: all 0.3s ease;
      width: 100%;
    }

    #downloadResume:hover, #downloadQuestions:hover {
      background: #e65b50;
      transform: translateY(-2px);
      box-shadow: 0 6px 14px rgba(255,111,97,0.5);
    }

    .download-hidden { display: none !important; }

    .container::-webkit-scrollbar { width: 8px; }
    .container::-webkit-scrollbar-thumb { background: #555; border-radius: 6px; }

    p { color: #ccc; line-height: 1.5; }

    .char-counter {
      font-size: 12px;
      color: #888;
      text-align: right;
      margin-top: -12px;
      margin-bottom: 16px;
    }

    @media (max-width: 900px) {
      .wrapper { flex-direction: column; }
      .container { max-height: none; margin-bottom: 20px; }
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="container">
      <h2>ATS Resume Builder</h2>
      <form id="resumeForm" enctype="multipart/form-data">
        
        <label for="resume">Paste your Resume Text:</label>
        <textarea id="resume" name="resume" placeholder="Paste your complete resume content here including:
- Personal details (Name, Email, Phone)
- Professional summary
- Education details  
- Skills (Technical & Soft)
- Work experience
- Projects with descriptions
- Certifications
- Any other relevant information..." required></textarea>
        <div class="char-counter" id="resumeCharCount">0 characters</div>

        <label for="jd">Paste the Job Description:</label>
        <textarea id="jd" name="jd" placeholder="Paste the job description text here..." required></textarea>
        <div class="char-counter" id="jdCharCount">0 characters</div>

        <h3>Extra Eligibility Info</h3>
        
        <label for="tenth">10th Percentage:</label>
        <input type="number" id="tenth" name="tenth" placeholder="e.g. 85" min="0" max="100" step="0.1"/>

        <label for="twelfth">12th Percentage:</label>
        <input type="number" id="twelfth" name="twelfth" placeholder="e.g. 82" min="0" max="100" step="0.1"/>

        <label for="cgpa">Graduation CGPA:</label>
        <input type="number" step="0.01" id="cgpa" name="cgpa" placeholder="e.g. 8.2" min="0" max="10"/>

        <label for="branch">Branch:</label>
        <select id="branch" name="branch">
          <option value="">-- Select Branch --</option>
          <option value="cse">Computer Science</option>
          <option value="cse">CSE( DS )</option>
          <option value="cse">CSE(AI & ML)</option>
          <option value="cse">Information Technology</option>
          <option value="ece">Electronics and Computer Science</option>
          <option value="ece">Electronics and Communication Engineering</option>
          <option value="mechanical">Mechanical Engg</option>
          <option value="civil">Civil Engg</option>
          <option value="other">Other</option>
        </select>

        <label for="gradYear">Graduation Year:</label>
        <select id="gradYear" name="gradYear">
          <option value="">-- Select Year --</option>
          <option value="2020">2020</option>
          <option value="2021">2021</option>
          <option value="2022">2022</option>
          <option value="2023">2023</option>
          <option value="2024">2024</option>
          <option value="2025">2025</option>
          <option value="2026">2026</option>
          <option value="2027">2027</option>
          <option value="2028">2028</option>
        </select>

        <label for="gap">Gap Years:</label>
        <select id="gap" name="gap">
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
        </select>

        <label for="live">Live Backlogs:</label>
        <select id="live" name="live">
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
        </select>

        <label for="dead">Dead Backlogs:</label>
        <select id="dead" name="dead">
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
        </select>

        <label for="experience">Experience (years):</label>
        <select id="experience" name="experience">
          <option value="0">0</option>
          <option value="0.5"><1</option>
          <option value="1">1+</option>
          <option value="2">2+</option>
          <option value="3">3+</option>
          <option value="4">4+</option>
          <option value="5">5+</option>
        </select>

        <button type="submit" id="submitBtn">Generate ATS-Optimized Resume</button>
      </form>
    </div>

    <div class="container">
      <h2>Generated Files</h2>
      <p>Your ATS-optimized resume and interview questions will appear below:</p>
      <a id="downloadResume" href="#" target="_blank" class="download-hidden">üìÑ Download ATS Resume</a>
      <a id="downloadQuestions" href="#" target="_blank" class="download-hidden">‚ùì Download Interview Questions</a>
    </div>
  </div>

  <script>
    const resumeForm = document.getElementById('resumeForm');
    const downloadResume = document.getElementById('downloadResume');
    const downloadQuestions = document.getElementById('downloadQuestions');
    const submitBtn = document.getElementById('submitBtn');
    const resumeTextarea = document.getElementById('resume');
    const jdTextarea = document.getElementById('jd');
    const resumeCharCount = document.getElementById('resumeCharCount');
    const jdCharCount = document.getElementById('jdCharCount');

    // Character counter for resume textarea
    resumeTextarea.addEventListener('input', function() {
      const length = this.value.length;
      resumeCharCount.textContent = `${length} characters`;
      
      if (length < 100) {
        resumeCharCount.style.color = '#ff6f61';
      } else if (length < 500) {
        resumeCharCount.style.color = '#ffcc00';
      } else {
        resumeCharCount.style.color = '#00e0ff';
      }
    });

    // Character counter for JD textarea
    jdTextarea.addEventListener('input', function() {
      const length = this.value.length;
      jdCharCount.textContent = `${length} characters`;
      
      if (length < 50) {
        jdCharCount.style.color = '#ff6f61';
      } else if (length < 200) {
        jdCharCount.style.color = '#ffcc00';
      } else {
        jdCharCount.style.color = '#00e0ff';
      }
    });

    // Auto-resize textareas
    function autoResize(textarea) {
      textarea.style.height = 'auto';
      textarea.style.height = Math.max(textarea.scrollHeight, 120) + 'px';
    }

    resumeTextarea.addEventListener('input', function() {
      autoResize(this);
    });

    jdTextarea.addEventListener('input', function() {
      autoResize(this);
    });

    resumeForm.addEventListener('submit', async (e) => {
      e.preventDefault();

      // Validation
      if (resumeTextarea.value.trim().length < 100) {
        alert("‚ö†Ô∏è Please provide a more detailed resume (at least 100 characters)");
        resumeTextarea.focus();
        return;
      }

      if (jdTextarea.value.trim().length < 50) {
        alert("‚ö†Ô∏è Please provide a more detailed job description (at least 50 characters)");
        jdTextarea.focus();
        return;
      }

      const formData = new FormData(resumeForm);

      submitBtn.disabled = true;
      submitBtn.textContent = "üîÑ Optimizing Resume...";

      try {
        const response = await fetch('/generate', { 
          method: 'POST', 
          body: formData 
        });
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const result = await response.json();

        if (result.error) {
          alert("‚ùå Error: " + result.error);
          return;
        }

        if (result.resume_pdf_url) {
          downloadResume.href = result.resume_pdf_url;
          downloadResume.classList.remove('download-hidden');
        }

        if (result.questions_pdf_url) {
          downloadQuestions.href = result.questions_pdf_url;
          downloadQuestions.classList.remove('download-hidden');
        }

        alert("‚úÖ ATS-Optimized resume generated successfully!");

      } catch (err) {
        console.error('Error:', err);
        alert("‚ùå Error generating PDFs: " + err.message);
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = "Generate ATS-Optimized Resume";
      }
    });
  </script>
</body>
</html>
